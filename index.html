<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>War Machine Optimizer</title>
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<style>
			html {
				scrollbar-gutter: stable;
			}

			/* Header gradient background */
			.header-gradient {
				background: linear-gradient(135deg, rgba(13, 110, 253, 0.1) 0%, rgba(13, 110, 253, 0.05) 100%);
			}

			/* Card hover effect */
			.card-hover:hover {
				box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
				transition: all 0.2s ease;
			}

			.list-group-item.active,
			.list-group-item.active * {
				color: whitesmoke !important;
				background-color: rgb(38, 63, 110);
			}

			/* Sticky optimize section gradient */
			.optimize-section {
				background: linear-gradient(to top, var(--bs-body-bg) 80%, transparent);
			}

			/* Mode selector custom styling */
			.mode-selector {
				display: inline-flex;
				background: rgba(255, 255, 255, 0.05);
				border: 1px solid rgba(255, 255, 255, 0.1);
			}

			.mode-selector input[type="radio"] {
				display: none;
			}

			.mode-selector label {
				cursor: pointer;
				transition: all 0.2s ease;
				color: rgba(255, 255, 255, 0.6);
				margin: 0;
			}

			.mode-selector label:hover {
				background: rgba(255, 255, 255, 0.08);
				color: rgba(255, 255, 255, 0.9);
			}

			.mode-selector input[type="radio"]:checked + label {
				background: rgba(13, 110, 253, 0.2);
				color: #fff;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}

			/* Optimize button hover effect */
			#optimizeBtn:hover:not(:disabled) {
				transform: translateY(-2px);
				box-shadow: 0 6px 16px rgba(255, 193, 7, 0.4);
			}

			#optimizeBtn:active:not(:disabled) {
				transform: translateY(0);
			}

			/* Fade-in animation */
			.machine-detail-view,
			.hero-detail-view,
			.artifacts-view,
			.tavern-view,
			.scarab-view,
			.results-view {
				animation: fadeIn 0.3s ease-in;
			}

			@keyframes fadeIn {
				from {
					opacity: 0;
					transform: translateY(10px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}
		</style>
	</head>

	<body>
		<div class="container-xxl py-4">
			<!-- Header -->
			<header class="header-gradient border-bottom rounded-3 p-4 mb-4">
				<div class="d-flex justify-content-between align-items-center">
					<span class="fs-4 fw-bold">War Machine Optimizer</span>
					<button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#saveLoadModal" id="saveLoadBtn">Save / Load</button>
				</div>
			</header>

			<!-- Save/Load Modal -->
			<div class="modal fade" id="saveLoadModal" tabindex="-1">
				<div class="modal-dialog modal-lg modal-dialog-centered">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title">Save / Load Configuration</h5>
							<button type="button" class="btn-close user-select-none" data-bs-dismiss="modal"></button>
						</div>
						<div class="modal-body">
							<p class="text-secondary small">Click <strong>Save</strong> to generate JSON, then copy it. Paste saved JSON here and click <strong>Load</strong> to restore.</p>
							<textarea id="saveLoadBox" class="form-control font-monospace" rows="12" placeholder="generate a save or insert one here..."></textarea>
						</div>
						<div class="modal-footer">
							<button id="saveBtn" type="button" class="btn btn-success user-select-none">Save</button>
							<button id="loadBtn" type="button" class="btn btn-primary user-select-none">Load</button>
							<button type="button" class="btn btn-secondary user-select-none" data-bs-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>

			<!-- Navigation -->
			<nav class="navbar mt-3">
				<ul class="nav nav-tabs w-100 justify-content-center gap-2 p-2 rounded-3 bg-body-tertiary bg-opacity-25" id="wmTabs">
					<li class="nav-item">
						<a class="nav-link active px-3 py-2 fw-semibold rounded-2 user-select-none" draggable="false" data-bs-toggle="tab" href="#machinesTab">Machines</a>
					</li>
					<li class="nav-item">
						<a class="nav-link px-3 py-2 fw-semibold rounded-2 user-select-none" draggable="false" data-bs-toggle="tab" href="#tavernTab">Tavern</a>
					</li>
					<li class="nav-item">
						<a class="nav-link px-3 py-2 fw-semibold rounded-2 user-select-none" draggable="false" data-bs-toggle="tab" href="#heroesTab">Heroes</a>
					</li>
					<li class="nav-item">
						<a class="nav-link px-3 py-2 fw-semibold rounded-2 user-select-none" draggable="false" data-bs-toggle="tab" href="#artifactsTab">Artifacts</a>
					</li>
					<li class="nav-item">
						<a class="nav-link px-3 py-2 fw-semibold rounded-2 user-select-none" draggable="false" data-bs-toggle="tab" href="#resultsTab">Results</a>
					</li>
				</ul>
			</nav>

			<!-- Main Content -->
			<main class="container-fluid tab-content py-4">
				<!-- MACHINES TAB -->
				<section id="machinesTab" class="tab-pane fade show active">
					<!-- Global Bonuses -->
					<div class="card card-hover mb-4 bg-success bg-opacity-10 border-success border-opacity-25">
						<div class="card-body">
							<h5 class="card-title mb-3">Global Bonuses</h5>
							<div class="row g-3">
								<div class="col-12 col-md-6">
									<label for="engineerLevel" class="form-label">Engineer Level</label>
									<input type="number" id="engineerLevel" class="form-control" min="0" step="1" value="0" />
								</div>
								<div class="col-12 col-md-6">
									<label for="scarabLevel" class="form-label">Scarab Level</label>
									<input type="number" id="scarabLevel" class="form-control" min="0" step="1" value="0" />
								</div>
								<div class="col-12 col-md-6">
									<label for="riftRank" class="form-label">Chaos Rift Rank</label>
									<select id="riftRank" class="form-select">
										<!-- Populated through App.js -->
									</select>
								</div>
							</div>
						</div>
					</div>

					<!-- Machine List and Details -->
					<div class="row g-3">
						<div class="col-12 col-lg-4">
							<div class="card card-hover">
								<div class="card-header">
									<h5 class="mb-0">Machine List</h5>
								</div>
								<div class="card-body p-0">
									<div id="machineList" class="list-group list-group-flush overflow-auto" style="max-height: 600px"></div>
								</div>
							</div>
						</div>

						<div class="col-12 col-lg-8">
							<div class="card card-hover">
								<div class="card-header">
									<h5 class="mb-0">Machine Details</h5>
								</div>
								<div class="card-body">
									<div id="machineDetails"></div>
								</div>
							</div>
						</div>
					</div>
				</section>

				<!-- TAVERN TAB -->
				<section id="tavernTab" class="tab-pane fade">
					<div class="mb-4">
						<h4 class="mb-1">Tavern & Scarab's Game</h4>
						<p class="text-secondary mb-0">Manage card levels for all machines</p>
					</div>

					<!-- Sub-tabs for Tavern and Scarab's Game -->
					<div class="d-flex justify-content-center mb-4">
						<div class="mode-selector gap-2 p-2 rounded-3 shadow">
							<input type="radio" id="tavernSubTab" name="tavernMode" value="tavern" checked />
							<label for="tavernSubTab" class="px-4 py-2 rounded-2 fw-medium user-select-none">Tavern (Sacred Cards)</label>

							<input type="radio" id="scarabSubTab" name="tavernMode" value="scarab" />
							<label for="scarabSubTab" class="px-4 py-2 rounded-2 fw-medium user-select-none">Scarab's Game (Inscription Cards)</label>
						</div>
					</div>

					<!-- Tavern Content -->
					<div id="tavernCardsContainer"></div>

					<!-- Scarab Content -->
					<div id="scarabCardsContainer" class="d-none"></div>
				</section>

				<!-- HEROES TAB -->
				<section id="heroesTab" class="tab-pane fade">
					<div class="row g-3">
						<div class="col-12 col-lg-4">
							<div class="card card-hover">
								<div class="card-header">
									<h5 class="mb-0">Hero List</h5>
								</div>
								<div class="card-body p-0">
									<div id="heroList" class="list-group list-group-flush overflow-auto" style="max-height: 600px"></div>
								</div>
							</div>
						</div>

						<div class="col-12 col-lg-8">
							<div class="card card-hover">
								<div class="card-header">
									<h5 class="mb-0">Hero Details</h5>
								</div>
								<div class="card-body">
									<div id="heroDetails"></div>
								</div>
							</div>
						</div>
					</div>
				</section>

				<!-- ARTIFACTS TAB -->
				<section id="artifactsTab" class="tab-pane fade">
					<div class="mb-4 d-flex justify-content-between align-items-center">
						<div>
							<h4 class="mb-1">Artifact Configuration</h4>
							<p class="text-secondary mb-0">Configure artifacts by stat type and percentage tier</p>
						</div>
						<button type="button" class="btn btn-sm btn-outline-danger" id="resetArtifacts">Reset All</button>
					</div>
					<div id="artifactsContainer" class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-3 artifacts-view"></div>
				</section>

				<!-- RESULTS TAB -->
				<section id="resultsTab" class="tab-pane fade">
					<div class="card p-4 bg-body-tertiary bg-opacity-25">
						<h4 class="mb-3">Optimization Results</h4>
						<p class="text-secondary">Click the <strong>Optimize</strong> button to calculate your best formation.</p>
						<p class="text-secondary small">
							<!--<em>Note: This optimizer does not account for abilities. Therefore, you may be able to earn more stars than what is shown.</em>-->
						</p>
						<div id="resultsContainer"></div>
					</div>
				</section>
			</main>

			<!-- Toast Container -->
			<div aria-live="polite" aria-atomic="true">
				<div id="toastRoot" class="toast-container position-fixed bottom-0 end-0 p-3"></div>
			</div>

			<!-- Footer -->
			<footer class="text-center mt-5 pt-4 border-top border-opacity-10 text-white-50">
				<small>Â© 2025 War Machine Optimizer</small>
			</footer>
		</div>

		<!-- OPTIMIZE SECTION (Sticky) -->
		<div class="optimize-section py-4 sticky-bottom">
			<div class="d-flex flex-column align-items-center gap-3">
				<div class="mode-selector gap-2 p-2 rounded-3 shadow">
					<input type="radio" id="campaignMode" name="optimizeMode" value="campaign" checked />
					<label for="campaignMode" class="px-4 py-2 rounded-2 fw-medium user-select-none">Campaign</label>

					<input type="radio" id="arenaMode" name="optimizeMode" value="arena" />
					<label for="arenaMode" class="px-4 py-2 rounded-2 fw-medium user-select-none">Arena</label>
				</div>

				<button
					id="optimizeBtn"
					class="btn btn-warning btn-lg fw-semibold shadow px-5 py-3"
					style="min-width: 200px; font-size: 1.1rem; letter-spacing: 0.02em; box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3); transition: all 0.2s ease">
					Optimize for Campaign
				</button>
			</div>
		</div>

		<!-- Templates -->		
		<template id="machineTemplate">
			<div class="machine-card border rounded p-3 mb-2 text-center shadow-sm">
				<img class="machine-image mb-2 rounded" src="" alt="Machine" style="width: 80px; height: 80px; object-fit: cover" />
				<div class="machine-name fw-bold mb-2"></div>
				<div class="machine-stats d-flex justify-content-center gap-3 align-items-center mb-2">
					<div class="stat damage d-flex align-items-center gap-1">
						<img src="img/ui/damage.webp" alt="Damage" style="width: 20px; height: 20px" />
						<span class="value fw-bold"></span>
					</div>
					<div class="stat health d-flex align-items-center gap-1">
						<img src="img/ui/health.webp" alt="Health" style="width: 20px; height: 20px" />
						<span class="value fw-bold"></span>
					</div>
					<div class="stat armor d-flex align-items-center gap-1">
						<img src="img/ui/armor.webp" alt="Armor" style="width: 20px; height: 20px" />
						<span class="value fw-bold"></span>
					</div>
				</div>
				<div class="crew d-flex flex-wrap justify-content-center gap-1 mt-2"></div>
			</div>
		</template>

		<!-- Bootstrap 5.3.8 -->
		<script src="js/vendor/bootstrap.bundle.min.js"></script>
		<script type="module" src="js/app.js"></script>
	</body>
</html>
